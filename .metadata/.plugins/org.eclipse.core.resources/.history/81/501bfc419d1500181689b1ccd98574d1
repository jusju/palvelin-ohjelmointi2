package palvelinohjelmointi.Bookstore.web;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.security.core.userdetails.UserDetails;
import org.springframework.security.core.userdetails.UsernameNotFoundException;
import org.springframework.stereotype.Service;

import palvelinohjelmointi.Bookstore.domain.UserRepository;

@Service
public interface UserDetailService implements UserDetailsService {
		private UserRepository repository;
		@Autowired
		public UserDetailService(UserRepository repository){
			this.repository = repository;
		}
		
		@Override
		public UserDetails loadUserByUsername(String username) throws
		UsernameNotFoundException {
			User curruser = repository.findByUsername(username);
			UserDetails user = new org.springframework.security.core.userdetails.User(username,
					curruser.getPasswordHash(),
					AuthorityUtils.createAuthorityList(curruser.getRole()));
					return user;
					}
					}
		}
}
